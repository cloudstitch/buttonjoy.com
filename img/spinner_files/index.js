function import$(e,n){var t={}.hasOwnProperty;for(var o in n)t.call(n,o)&&(e[o]=n[o]);return e}var x$;x$=angular.module("loadingIO",["backend"]),x$.service("ldNotify",["$rootScope","$timeout"].concat(function(e,n){return import$(this,{queue:[],send:function(e,t){var o,r=this;return this.queue.push(o={type:e,message:t}),n(function(){return r.queue.splice(r.queue.indexOf(o),1)},2900)}})})),x$.controller("ldMain",["$scope","$http","$interval","global","ldNotify"].concat(function(e,n,t,o,r){var a;return e.trackEvent=function(e,n,t,o){return ga("send","event",e,n,t,o)},e.notifications=r.queue,e.link={palette:{open:function(e){return window.location.href="/palette/"+e}}},e.nexturl=(a=/nexturl=([^&]+)/.exec(window.location.search||""))?a[1]:window.location.href,e.user={data:o.user},e.auth={email:"",passwd:"",show:!1,stick:!1,failed:"",keyHandler:function(e){return 13===e.keyCode?this.login():void 0},logout:function(){return console.log("logout.."),n({url:"/u/logout",method:"GET"}).success(function(){return console.log("logouted."),e.user.data=null,window.location.reload()}).error(function(){return r.send("danger","Failed to Logout. ")})},login:function(){var t=this;return n({url:"/u/login",method:"POST",data:$.param({email:this.email,passwd:this.passwd}),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(n){return e.auth.failed="",e.user.data=n,ga("set","&uid",n.key),t.show=!1,e.nexturl?window.location.href=e.nexturl:"/u/login"===window.location.pathname?window.location.href="/":window.location.reload()}).error(function(n,t){return e.auth.failed=403===t?(n.message||(n.message=[])).length?n.message[0]:"email or password incorrect":"system error, please try later"}),this.passwd=""}},window.addEventListener("scroll",function(){var e;return e=$(window).scrollTop(),60>e?$("#nav-top").removeClass("dim"):$("#nav-top").addClass("dim")}),e.$watch("user.data",function(n){return n&&n.key?ga("set","dimension1",e.user.data.key):void 0},!0)}));